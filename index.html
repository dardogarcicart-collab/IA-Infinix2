<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Infinix AI v4 - IA Conversacional Avanzada">
    <meta name="author" content="Infinix Team">
    <meta name="theme-color" content="#10a37f">
    <title>Infinix AI</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Pantalla de carga -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-container">
            <svg class="loading-spinner" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="6"/>
                <circle cx="50" cy="50" r="8" fill="currentColor"/>
                <circle cx="50" cy="15" r="5" fill="currentColor">
                    <animate attributeName="opacity" values="1;0.3;1" dur="2s" repeatCount="indefinite"/>
                </circle>
            </svg>
            <div class="loading-text">Iniciando Infinix AI...</div>
        </div>
    </div>

    <!-- Interfaz Principal (tipo ChatGPT) -->
    <div id="main-interface" class="app-container">
        <!-- HEADER -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-left">
                    <button class="menu-btn" id="menuBtn" aria-label="MenÃº">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <h1 class="app-title">Infinix AI</h1>
                </div>
                <div class="header-right">
                    <span class="personality-badge" id="personalityBadge">neutral</span>
                    <button id="toggleTheme" class="icon-btn" aria-label="Cambiar tema" title="Tema">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"/>
                            <line x1="12" y1="1" x2="12" y2="3"/>
                            <line x1="12" y1="21" x2="12" y2="23"/>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                            <line x1="1" y1="12" x2="3" y2="12"/>
                            <line x1="21" y1="12" x2="23" y2="12"/>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                        </svg>
                    </button>
                    <button id="settingsBtn" class="icon-btn" aria-label="ConfiguraciÃ³n" title="ConfiguraciÃ³n">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m2.12 2.12l4.24 4.24M1 12h6m6 0h6M4.22 19.78l4.24-4.24m2.12-2.12l4.24-4.24M19.78 4.22l-4.24 4.24m-2.12 2.12l-4.24 4.24M23 12h-6m-6 0H5M19.78 19.78l-4.24-4.24m-2.12-2.12l-4.24-4.24"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- ÃREA PRINCIPAL (Chat) -->
        <main class="chat-area">
            <!-- Bienvenida inicial -->
            <div id="welcomeArea" class="welcome-area">
                <div class="welcome-container">
                    <h2>Infinix AI</h2>
                    <p>ConversaciÃ³n inteligente con personalidad configurable</p>
                    <div class="quick-commands">
                        <button class="quick-cmd" onclick="sendMessage()">Hola</button>
                        <button class="quick-cmd" onclick="document.getElementById('userInput').value = 'Cambiar personalidad a friendly'; sendMessage();">Amigable</button>
                        <button class="quick-cmd" onclick="document.getElementById('userInput').value = '2+2'; sendMessage();">MatemÃ¡ticas</button>
                        <button class="quick-cmd" onclick="document.getElementById('userInput').value = 'CÃ³digo en JavaScript'; sendMessage();">CÃ³digo</button>
                    </div>
                </div>
            </div>

            <!-- Contenedor de mensajes (scroll) -->
            <div id="chatContainer" class="messages-container" role="main" aria-live="polite" aria-label="Chat">
            </div>

            <!-- Indicador de escritura -->
            <div id="typingIndicator" class="typing-indicator hidden">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </main>

        <!-- FOOTER (Input de texto) -->
        <footer class="chat-footer">
            <div class="input-container">
                <form id="messageForm" onsubmit="handleSubmit(event)">
                    <div class="input-wrapper">
                        <textarea 
                            id="userInput" 
                            class="message-input" 
                            placeholder="Escribe tu mensaje aquÃ­... (Shift+Enter para salto de lÃ­nea)"
                            aria-label="Campo de entrada"
                            autocomplete="off"
                            rows="1"></textarea>
                        <button type="submit" class="send-btn" aria-label="Enviar mensaje" title="Enviar">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 L4.13399899,1.16151496 C3.34915502,0.9 2.40734225,0.9 1.77946707,1.4 C0.994623095,2.0636533 0.837654326,3.1 1.15159189,3.99 L3.03521743,10.4310031 C3.03521743,10.5881005 3.19218622,10.7451979 3.50612381,10.7451979 L16.6915026,11.5306849 C16.6915026,11.5306849 17.1624089,11.5306849 17.1624089,12.0006428 C17.1624089,12.4744748 16.6915026,12.4744748 16.6915026,12.4744748 Z"/>
                            </svg>
                        </button>
                    </div>
                </form>
                <div class="input-info">
                    <small>Presiona Ctrl+Enter para enviar</small>
                </div>
            </div>
        </footer>

        <!-- Panel lateral de configuraciÃ³n (oculto por defecto) -->
        <aside id="settingsPanel" class="settings-panel hidden">
            <div class="settings-header">
                <h3>ConfiguraciÃ³n</h3>
                <button class="close-btn" onclick="document.getElementById('settingsPanel').classList.add('hidden')">âœ•</button>
            </div>
            <div class="settings-content">
                <div class="setting-group">
                    <label>Personalidad</label>
                    <select id="personalitySelect" onchange="cambiarPersonalidad(this.value)">
                        <option value="neutral">Neutral</option>
                        <option value="friendly">Amigable</option>
                        <option value="sarcastic">SarcÃ¡stica</option>
                        <option value="academic">AcadÃ©mica</option>
                        <option value="chaotic">CaÃ³tica</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>VersiÃ³n de IA</label>
                    <select id="versionSelect" onchange="cambiarVersion(this.value)">
                        <option value="4">Infinix 4</option>
                        <option value="5">Fanix 5</option>
                        <option value="6">Infinix 6</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>Tu apodo</label>
                    <div class="nickname-input">
                        <input type="text" id="nicknameInput" placeholder="Deja en blanco para no usar apodo">
                        <button onclick="establecerApodo()">Guardar</button>
                    </div>
                </div>
                <div class="setting-group">
                    <button class="btn-danger" onclick="limpiarChat()">Limpiar Chat</button>
                </div>
            </div>
        </aside>
    </div>

    <!-- Modal de grÃ¡ficas -->
    <div id="graphModal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-content">
            <button class="modal-close" onclick="cerrarModal('graphModal')">âœ•</button>
            <h2>Graficar funciÃ³n</h2>
            <div class="graph-controls">
                <input id="graphExpr" type="text" placeholder="f(x) = x^2" />
                <button onclick="graficarFuncion()">Graficar</button>
            </div>
            <canvas id="graphCanvas" width="600" height="400"></canvas>
        </div>
    </div>

    <!-- Modal de cÃ³digo -->
    <div id="codeModal" class="modal hidden" role="dialog" aria-hidden="true">
        <div class="modal-content code-modal-content">
            <button class="modal-close" onclick="cerrarModal('codeModal')">âœ•</button>
            <div class="code-header">
                <h2 id="codeLang">CÃ³digo</h2>
                <button class="copy-btn" onclick="copiarCodigo()">ðŸ“‹ Copiar</button>
            </div>
            <pre><code id="codeBlock" class="code-block"></code></pre>
        </div>
    </div>

    <!-- Scripts en orden correcto de carga -->
    <!-- 1. Core -->
    <script src="js/config.js"></script>
    <script src="js/logger.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/personality.js"></script>
    <script src="js/language_analyzer.js"></script>
    
    <!-- 2. Sistemas avanzados -->
        <script src="js/ideas_system.js"></script>
    <script src="js/plugins_system.js"></script>
    <script src="js/user_profiles.js"></script>
    <script src="js/rules_engine.js"></script>
    <script src="js/learning_system.js"></script>
    
    <!-- 3. IA y generaciÃ³n de cÃ³digo -->
    <script src="js/ai_engine.js"></script>
    <script src="js/code_generator.js"></script>
    
    <!-- 4. Debug y orquestador principal -->
    <script src="js/debug_panel.js"></script>
    <script src="js/script.js"></script>

    <!-- InicializaciÃ³n cuando DOM estÃ¡ listo -->
    <script>
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', inicializarApp);
        } else {
            inicializarApp();
        }
        
        // Atajos de teclado
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                sendMessage();
            }
            if (e.ctrlKey && e.key === 'd') {
                e.preventDefault();
                DebugPanel?.toggle?.();
            }
        });
    </script>
</body>
</html>

        <!-- Ãrea de entrada (footer) - formulario accesible -->
        <footer class="input-area" role="contentinfo" aria-label="Ãrea de entrada">
            <label for="userInput" class="visually-hidden">Escribe tu mensaje o ecuaciÃ³n</label>
            <input 
                type="text" 
                id="userInput" 
                placeholder="Escribe tu mensaje o ecuaciÃ³n aquÃ­..." 
                aria-label="Campo de entrada de mensaje"
                autocomplete="off"
            />
            <button onclick="sendMessage()" aria-label="Enviar mensaje">Enviar</button>
        </footer>aquÃ­..." 
                aria-label="Campo de entrada"
                autocomplete="off"
            />s -->
    <div id="graphModal" class="graph-modal" role="dialog" aria-hidden="true">
        <div class="graph-content" role="document">
            <button id="closeGraph" class="graph-close" aria-label="Cerrar grÃ¡fica">âœ•</button>
            <div class="graph-header">
                <label for="graphExpr">f(x) = </label>
                <input id="graphExpr" type="text" placeholder="ej: x^2 or sin(x)" aria-label="ExpresiÃ³n" />
                <button id="plotBtn">Graficar</button>
            </div>
            <canvas id="graphCanvas" width="800" height="360" aria-label="GrÃ¡fica"></canvas>
        </div>
    </div>

    <!-- Modal de cÃ³digo -->
    <div id="codeModal" class="code-modal" role="dialog" aria-hidden="true">
        <div class="code-content" role="document">
            <button id="closeCode" class="code-close" aria-label="Cerrar cÃ³digo">âœ•</button>
            <div class="code-header">
                <h2 id="codeLang">CÃ³digo</h2>
                <button id="copyCodeBtn">ðŸ“‹ Copiar</button>
            </div>
            <pre><code id="codeBlock" class="code-block"></code></pre>
        </div>
    </div>

    <!-- Scripts en orden correcto -->
    <!-- 1. Core -->
    <script src="js/config.js"></script>
    <script src="js/logger.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/personality.js"></script>
    <script src="js/language_analyzer.js"></script>
    
    <!-- 2. Sistemas avanzados -->
    <script src="js/plugins_system.js"></script>
    <script src="js/user_profiles.js"></script>
    <script src="js/rules_engine.js"></script>
    <script src="js/learning_system.js"></script>
    
    <!-- 3. IA y generaciÃ³n -->
    <script src="js/ai_engine.js"></script>
    <script src="js/code_generator.js"></script>
    
    <!-- 4. Debug y principal -->
    <script src="js/debug_panel.js"></script>
    <script src="js/script.js"></script>

    <!-- Inicializar cuando el DOM estÃ© listo -->
    <script>
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', inicializarApp);
        } else {
            inicializarApp();
        }     e.preventDefault();
                DebugPanel?.toggle?.();
            }
        });
    </script>
</body>
</html>